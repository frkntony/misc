<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="abstract" content="The SQL trace provides a log of selected SQL statements with details about when a statement was executed and its duration, allowing you to identify inefficient SQL statements used in your applications and investigate performance issues. SQL trace records are integrated in the standard trace log files written at runtime."/>
<meta name="description" content="The SQL trace provides a log of selected SQL statements with details about when a statement was executed and its duration, allowing you to identify inefficient SQL statements used in your applications and investigate performance issues. SQL trace records are integrated in the standard trace log files written at runtime."/>

<link rel="stylesheet" type="text/css" href="../css/documentation.css"/>
<title>Investigating Performance Issues Using the SQL Trace</title>
<!--[if lte IE 7]><style>
      .codeblock{
          overflow:visible;
      }</style><![endif]-->
</head>
<body class="" id="loioe820e184bb5710149196a0f47db853cd">
<div id="wrapper"><div id="container">
<h1 class="title topictitle1">Investigating Performance Issues Using the SQL Trace</h1>

	
	<div class="body taskbody"><p class="shortdesc">The SQL trace provides a log of selected SQL statements with details about when a
		statement was executed and its duration, allowing you to identify inefficient SQL statements
		used in your applications and investigate performance issues. SQL trace records are
		integrated in the standard trace log files written at runtime.</p>

		<div class="section context"><div class="tasklabel"><h2 class="sectiontitle tasklabel">Context</h2></div>
			<p class="p">The SQL trace is disabled by default. Generally, you enable it when you require SQL trace
				information for a particular application and disable it again once you have
				completed your investigation. It is not intended for general performance
				monitoring.</p>

			<p class="p">You can use the cockpit to enable the SQL trace by setting the log level of the logger
					<span class="ph filepath">com.sap.core.persistence.sql.trace</span> to the log level
					<span class="keyword">DEBUG</span> in the application’s log configuration. SQL trace
				information can subsequently be viewed in the log files. </p>

		</div>
	</div>

	<div class="related-links"> 
</div>
<div class="topic task nested1" id="task_jjv_tbh_gn">
		<h2 class="title topictitle2">Enable the SQL Trace</h2>

		<div class="body taskbody">
			<div class="ol steps tasklabel"><h3 class="sectiontitle tasklabel">Procedure</h3></div><ol class="ol steps" id="task_jjv_tbh_gn__steps_hlw_3ch_gn"><li class="li step stepexpand">
					<span class="ph cmd">Log onto the cockpit and choose <span class="ph menucascade"><img src="../images/navstart.gif" alt="Start of the navigation path" title="Start of the navigation path"/> <span class="ph uicontrol">Applications</span> <img src="../images/navstep.gif" alt="Next navigation step" title="Next navigation step"/> <span class="ph uicontrol">Java Applications</span> <img src="../images/navend.gif" alt="End of the navigation path" title="End of the navigation path"/></span> in the navigation area.</span>
				</li>
<li class="li step stepexpand">
					<span class="ph cmd">Click the relevant application to go to the dashboard.</span>
				</li>
<li class="li step stepexpand">
					<span class="ph cmd">Choose <span class="ph menucascade"><img src="../images/navstart.gif" alt="Start of the navigation path" title="Start of the navigation path"/> <span class="ph uicontrol">Monitoring</span> <img src="../images/navstep.gif" alt="Next navigation step" title="Next navigation step"/> <span class="ph uicontrol">Logging</span> <img src="../images/navend.gif" alt="End of the navigation path" title="End of the navigation path"/></span> in the navigation area.</span>
				</li>
<li class="li step stepexpand">
					<span class="ph cmd">Choose <span class="ph uicontrol">Configure Loggers</span>. </span>
					<div class="itemgroup stepresult">In the <span class="ph uicontrol">Logger Configuration</span> dialog box, all
						loggers used since the application was started are listed with the log
						levels that are currently applicable.<div class="note note"><span class="notetitle">Note</span> You can only set log levels when
							an application is running. Loggers are not listed if the relevant
							application code has not been executed.</div>
</div>
				</li>
<li class="li step stepexpand">
					<span class="ph cmd">Enter <kbd class="ph userinput">com.sap.core.persistence.sql.trace</kbd> in the
							<span class="ph uicontrol">Filter</span> field.</span>
				</li>
<li class="li step stepexpand">
					<span class="ph cmd">In the row containing the
							<span class="ph filepath">com.sap.core.persistence.sql.trace</span> logger, select
						the log level <kbd class="ph userinput">Debug</kbd> from the dropdown list:</span>
					<div class="itemgroup info">
						<p class="p"><img class="image" id="task_jjv_tbh_gn__image_mp4_mbx_sn" src="loio32f5870f7b4544e4bd5d0450c4a73b40_LowRes.png"/></p>

						<p class="p">The new log setting takes effect immediately. Note that log settings are
							saved permanently and do not revert to their initial values when an
							application is restarted.</p>

					</div>
				</li>
</ol>

		</div>

	</div>

	<div class="topic task nested1" id="task_rnm_rbh_gn">
		<h2 class="title topictitle2">View the SQL Trace Details</h2>

		
		<div class="body taskbody"><p class="shortdesc">See the application's trace logs, which contain the SQL trace records, either in the
				<span class="ph uicontrol">Most Recent Logging</span> panel on the application dashboard or on
			the <span class="ph uicontrol">Logging</span> page by navigating to <span class="ph menucascade"><img src="../images/navstart.gif" alt="Start of the navigation path" title="Start of the navigation path"/> <span class="ph uicontrol">Monitoring</span> <img src="../images/navstep.gif" alt="Next navigation step" title="Next navigation step"/> <span class="ph uicontrol">Logging</span> <img src="../images/navend.gif" alt="End of the navigation path" title="End of the navigation path"/></span> in the navigation area. </p>

			<div class="ol steps tasklabel"><h3 class="sectiontitle tasklabel">Procedure</h3></div><div class="li step p">
					<span class="ph cmd">To display the contents of a particular log file, choose <img class="image" id="task_rnm_rbh_gn__image_m13_dcx_sn" src="loio54a37763137a481f95fcd990dc200bf4_LowRes.png"/>
							(<span class="ph uicontrol">Show</span>). Note that you can also download the file
						by choosing <img class="image" id="task_rnm_rbh_gn__image_bb3_dcx_sn" src="loiof0a3c0018a6544b399c3666fbb9f24b8_LowRes.png"/> (<span class="ph uicontrol">Download</span>).</span>
					<div class="itemgroup stepresult">
						<div class="p">In the log file, you can identify the SQL trace information by the logger
							name <span class="ph filepath">com.sap.core.persistence.sql.trace</span>.The entries
							written by the logger include the following details: <ul class="ul" id="task_rnm_rbh_gn__ul_ntv_z1y_sn">
								<li class="li">Date and time when written</li>

								<li class="li">System time in nanoseconds</li>

								<li class="li">The name of the interface and method that produced the log
									entry, for example, <samp class="ph codeph">java.sql.Connection.prepareStatement
										(sql)</samp></li>

								<li class="li">The status of the method call (<samp class="ph codeph">begin</samp> and
										<samp class="ph codeph">end</samp>)</li>

								<li class="li">The database connection ID, for example, <samp class="ph codeph">conn=[3d194ab9]</samp>
								</li>

								<li class="li">The text of the SQL statement, for example, <samp class="ph codeph">"INSERT INTO
										T_PERSONS (ID, FIRSTNAME, LASTNAME) VALUES (?, ?,
										?)"</samp>. Note that for security reasons parameter
									values are not shown.</li>

								<li class="li">Duration of the request (in milliseconds with microsecond precision), for example,
										<samp class="ph codeph">Request duration = 2,770.743µs</samp></li>

							</ul>
</div>

					</div>
				</div>

			<div class="example"><h2 class="exampletitle">Example</h2>The SQL-specific information from the default trace is shown below in plain text
				format:<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint nocode">#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:03 UTC 2014 - 4913676098596447 - javax.sql.DataSource.getConnection() - begin|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:03 UTC 2014 - 4913676344945627 - javax.sql.DataSource.getConnection() - end - conn=[3d194ab9] - Request duration = 227,773.804µs - Network traffic = 1462 bytes|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:03 UTC 2014 - 4913676677332569 - java.sql.Connection.prepareStatement(sql) - begin - conn=[3d194ab9]|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:03 UTC 2014 - 4913676723144228 - java.sql.Connection.prepareStatement(sql) - end - conn=[3d194ab9] - Request duration = 2,850.647µs - Network traffic = 384 bytes|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:03 UTC 2014 - 4913676723530647 - java.sql.PreparedStatement.executeUpdate() - begin - conn=[3d194ab9] - SQL="CREATE TABLE T_PERSONS (ID VARCHAR(255) PRIMARY KEY NOT NULL, FIRSTNAME VARCHAR (255),LASTNAME VARCHAR (255))"|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:03 UTC 2014 - 4913676736488953 - java.sql.PreparedStatement.executeUpdate() - end - conn=[3d194ab9] - Request duration = 12,760.375µs - Network traffic = 272 bytes|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:03 UTC 2014 - 4913676767170228 - java.sql.Connection.prepareStatement(sql) - begin - conn=[3d194ab9]|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:03 UTC 2014 - 4913676781082955 - java.sql.Connection.prepareStatement(sql) - end - conn=[3d194ab9] - Request duration = 12,987.704µs - Network traffic = 464 bytes|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:03 UTC 2014 - 4913676781376595 - java.sql.PreparedStatement.executeQuery() - begin - conn=[3d194ab9] - SQL="SELECT ID, FIRSTNAME, LASTNAME FROM T_PERSONS"|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:03 UTC 2014 - 4913676786626464 - java.sql.PreparedStatement.executeQuery() - end - conn=[3d194ab9] - Request duration = 5,118.69µs - Network traffic = 264 bytes|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:09 UTC 2014 - 4913682088475475 - java.sql.Connection.prepareStatement(sql) - begin - conn=[3d194ab9]|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:09 UTC 2014 - 4913682093620026 - java.sql.Connection.prepareStatement(sql) - end - conn=[3d194ab9] - Request duration = 4,676.661µs - Network traffic = 392 bytes|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:09 UTC 2014 - 4913682094713377 - java.sql.PreparedStatement.executeUpdate() - begin - conn=[3d194ab9] - SQL="INSERT INTO T_PERSONS (ID, FIRSTNAME, LASTNAME) VALUES (?, ?, ?)"|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:09 UTC 2014 - 4913682097611865 - java.sql.PreparedStatement.executeUpdate() - end - conn=[3d194ab9] - Request duration = 2,770.743µs - Network traffic = 336 bytes|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:09 UTC 2014 - 4913682099273612 - java.sql.Connection.prepareStatement(sql) - begin - conn=[3d194ab9]|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:09 UTC 2014 - 4913682100587082 - java.sql.Connection.prepareStatement(sql) - end - conn=[3d194ab9] - Request duration = 1,097.86µs - Network traffic = 464 bytes|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:09 UTC 2014 - 4913682100784872 - java.sql.PreparedStatement.executeQuery() - begin - conn=[3d194ab9] - SQL="SELECT ID, FIRSTNAME, LASTNAME FROM T_PERSONS"|
#DEBUG#com.sap.core.persistence.sql.trace#Thu Apr 10 13:25:09 UTC 2014 - 4913682104569784 - java.sql.PreparedStatement.executeQuery() - end - conn=[3d194ab9] - Request duration = 3,626.846µs - Network traffic = 308 bytes|
</pre></div>
</div>

		</div>

		<div class="related-links"> 
<div class="relinfo"><div class="relinfotitle ">Related Information</div>
<div><a class="link" href="269860ae2d3745f086008b0a5f7d49b5.html" title="Besides the cockpit, the SQL trace can be enabled from the Eclipse IDE and using the console client. Whichever tool you use, you need to set the log level of the logger com.sap.core.persistence.sql.trace to the log level DEBUG.">Alternative Tools for Enabling the SQL Trace</a></div>
<div><a class="link" href="e47748b5bb571014afedc70595804f3e.html" title="A web-based administration interface provides access to a number of functions for configuring and managing cloud applications, services, and accounts.">Cockpit</a></div>
<div><a class="link" href="2555df65182c4b09a25e56fa3b57b0a8.html" title="You can view the logs and change the log settings of any applications deployed in your account. The cockpit provides the following types of logs: default trace logs, HTTP access logs, and garbage collection logs.">Using Logs in the Cockpit</a></div>
</div>
</div>
	</div>
</div></div><div class="footer" id="custom-footer">
	<div id="custom-footerSpacer"><hr width="350px" align="left"/></div>
	<a class="copyright" href="copyright.html">Copyright</a><span class="separator"> | </span><a class="disclaimer" href="disclaimer.html">Important Disclaimers and Legal Information</a>
</div>

</body>
</html>